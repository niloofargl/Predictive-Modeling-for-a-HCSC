function [rmse_mae_wape_mape] = plotsmape(params,daily , recovered, death, hospital , icu , isshow)
 
%%%%CanadaAv
dailyt = [2.96	3.65	4.49	5.59	6.9	8.61	10.63	12.94	16.29	21.16	27.8	36.63	49.37	63.47	83.29	103.51	133.1	172.71	219.22	268.98	327.35	387.94	461.16	534.78	604.73	674.37	757.43	842.39	931.88	1023	1102.27	1175.59	1246.45	1292.2	1328.18	1347.27	1339.45	1335.02	1331.29	1319.33	1316.16	1318.71	1331.41	1362.67	1406.31	1451.06	1506.59	1561.51	1607.8	1647.88	1682.69	1693.27	1698.27	1690.02	1671.8	1654.82	1641.73	1651.31	1663.61	1672.1	1682.14	1693.61	1697.73	1690.18	1624.82	1562.31	1502.94	1439.33	1375.63	1310.43	1252.73	1227.82	1205	1181.41	1162.29	1147.39	1141.02	1132.76	1123.43	1114.2	1105.63	1096.47	1083.24	1064.29	1040.04	1010.47	976.9	940.73	903.39	863.1	821.86	787.12	756.59	726.9	695.88	664.73	635.96	609.24	578.35	544.39	511	481.84	455.06	432.33	413.51	398.33	387.35	378.92	372.43	365.51	359.63	350.57	341.71	333.59	329.33	324.12	316.76	311.59	311.12	310.04	307.88	302.47	296.78	299.53	297.16	293.41	291.53	291.71	295.9	303.2	307.92	316.63	327.02	339.73	353.88	369.14	387.33	408.12	427.47	447.73	466.18	483.02	493.31	495.06	490.02	484.29	475.49	465	452.76	431.55	421.37	413.51	406.06	397.22	388.63	380.35	393.96	390.51	387.98	386.16	386.04	386.98	388.39	381.02	383.14	382.92	382.22	383.31	384.78	388.31	389.02	390.69	396.43	403.29	408.71	414.92	419.71	430.45	443.53	455.35	469.02	484.94	500.82	519.41	517.22	534.92	552.57	568.61	583.63	600.45	616.96	671.53	686.47	708.55	739.41	775.8	816.35	861.78	893.14	950.39	1002.49	1049.1	1095.22	1141.43	1192.16	1242.8	1292.55	1353.76	1419.35	1494	1573.65	1646.2	1723.2	1806.14	1874.71	1947.84	2014.27	2078.43	2143.12	2179.16	2203.57	2242.29	2265.69	2276.53	2275.76	2267.39	2300.59	2326.1	2340.65	2366.1	2399.57	2434.92	2479.1	2514.29	2563.06	2609	2649.33	2703.1	2762.57	2819.33	2845.33	2903.49	2973	3042.43	3114.8	3186.35	3274.53	3446.41	3569.96	3696.69	3869	4026.12	4195.14	4381.27	4483	4591.76	4698.04	4737.53	4776.14	4826.45	4831.51	4870.41	4922.35	4969.41	5054.61	5155.57	5243.14	5352.31	5458.86	5561.88	5683.39	5802.18	5907.43	6009.71	6114.39	6202.84	6295.55	6361.76	6415.41	6471.82	6508.98	6522.29	6540.37	6552.86	6568.08	6583.8	6588.59	6605.22	6635.84	6649.06	6651.43	6660.08	6658.92	6590.59	6543.94	6483.55	6389.29	6342.35	6299.53	6294.71	6425.88	6521.63	6641.02	6895	7081.67	7269.22	7420.88	7557.22	7723	7890.27	7940.86	7995.65	8010.27	8011.29	7911.16	7756.82	7562.73	7361.33	7146.04	6934.53	6706.02	6508.94	6317.9	6116.59	5934.02	5770.61	5598.41	5437.02	5267.41	5107.65	4961.2	4810.96	4650.27	4501.24	4358.04	4226.86	4093.94	3965.24	3841.86	3739.53	3655.96	3570.16	3480.18	3404.47	3327.73	3227.41	3153.88	3069.53	3006.31	2959.88	2911.9	2878	2922.08	2920.29	2935.43	2943.31	2954.33	2972.16	2990.9	2965.16	2960.8	2950.43	2939.31	2929.86	2912.33	2892.94	2895.92	2901.9	2917.14	2941.51	2964.35	3008.33	3070.65	3105.1	3137.31	3164.22	3199.39	3247.43	3292.22	3327.65	3395.31	3479.06	3573.57	3688.33	3805.94	3933.67	4076.51	4226.29	4385.98	4561.82	4717.76	4892.27	5098.27	5325.69	5525.96	5730.41	5938.12	6177.94	6429.82	6636.43	6824.57	7103.31	7376.22	7645.33	7902.18	8112.39	8323.04	8513.88	8601.37	8658.76	8681.73	8649.67	8603.49	8547.29	8468.84	8374.53	8281.98	8182.12	8103.04	8027.92	7959.96	7913.16	7896.59	7876.49	7861.2	7840.61	7818.27	7775.61	7720	7630.47	7521.51	7395.86	7249.98	7076.2	6887.76	6672.16	6446.96	6221.27	5980	5733.94	5499	5261.94	5031.12	4757.2	4528.84	4306.43	4073.69	3837.67	3610.76	3390.12	3277.94	3080.53	2906.08	2757.96	2616.73	2483.57	2357.08	2185.16	2072.84	1957.61	1844.65	1742.12	1648	1565.94	1496.14	1424.71	1360.18	1302	1247.82	1193.12	1134.59	1076.92	1024.1	971.18	918.24	865.69	815.51	771.49	735.41	703.24	674.65	647	628.43	611.94	594.98	573.9	549.65	528.78	518.31	509.8	504.41	501.67	500.27	500.61	497.51	487.76	467.86	448.31	429.88	414.45	402.47	392.33	388.41	396.33	405.12	413.39	430.92	449.71	479.39	512.59	547.43	584.43	623.82	638.55	682.78	721.71	765.02	814.96	866.67	923.57	1049.65	1127.02	1218.96	1314	1414.53	1518.45	1618.61	1688.06	1761.35	1849.2	1935.82	2015.49	2093.39	2176.45	2255.02	2382.24	2469.55	2556.04	2647.8	2740.67	2828.29	2929.35	3001.55	3094.82	3189.47	3275.98	3358.86	3446.63	3388.69	3459.24	3511.29	3553.06	3596.1	3640.71	3676.98	3986.86	4048.06	4126.35	4211.86	4296.96	4375.63	4454.41	4368.51	4392.27	4394.76	4391.47	4369.86	4347.1	4317.84	4311.8	4300.96	4307.65	4271.51	4272.43	4274.2	4279.16	4236.24	4185.63	4113.84	4100.88	4022.06	3942.8	3870.96	3684.27	3613.8	3533	3412.78	3316.08	3217.39	3106.92	3231.55	3145.98	3083.45	3033.8	2985.24	2928.76	2873.9	2675	2566.88	2497.35	2429.02	2370.33	2325.04	2286.08	2296.24	2328.53	2264.69	2249.41	2236.27	2226.55	2222.59	2260.8	2314.02	2439.98	2455.98	2500.67	2542.06	2661.18	2650.06	2610.35	2552.04	2583.84	2568.8	2559.78	2386.69	2389.41	2410.2	2464.08	2496.59	2552.45	2607.2	2748.96	2799.47	2845.1	2844.08	2847.9	2856.94	2870.2	2890.71	2932.24	2983.98	3060.02	3149.57	3255.82	3377.18	3501.98	3641.71	3796.9	3991.71	4223.94	4520.2	4863.55	5296.61	5874.55	6572.84	7409.33	8463.67	9728.73	11178.88	12716.41	14214.59	15826.43	17942.14	20087.82	22284.08	24560.1	26958.45	29595.65	32823.1	35165.53	37350.57	39260.39	40731.41	41707.57	42670.39	42008.76	41414.12	40429.67	39106.76	37636.39	36218.35	34145.65	32686.14	31136.1	29671.39	28298.73	27059.63	25829.24	24581.94	23370.61	22311.43	21299.67	20339.98	19410.94	18503.2	17796.53	17129.63	16456.53	15805.82	15200.82	14631	14111.84	13582.37	13101.49	12601.02	12123.06	11640.78	11169.63	10703.76	10291.55	9847.9	9443.08	9026.69	8676.22	8330.49	7999.1	7537.33	7196.35	6930.67	6719.08	6500.69	6281.98	6109.94	6251.84	6244.41	6179.55	6119.33	6069.27	6069.08	6016.57	5824.39	5740	5687.08	5641.33	5619.08	5579.73	5567.22	5533.8	5472.51	5419.73	5387.82	5263.04	5145.88	5035.59	5012.69	5116.69	5199.63	5300.92	5549.69	5822.8	6123	6335.71	6468.14	6698.69	6918.73	7139.76	7362.69	7587.55	7808.65	7773.22	7910.02	8049.67	8190.35	8306.31	8403.24	8609.92	9192.82	9327.41	9619.73	9579.37	9613.57	9546.27	9426.33	9117.84	8924.53	8395.8	8381.31	8178.73	8143.14	8046.88	7951.08	8012.12	8176.2	7986.9	7870.76	7626.76	7409.92	7211.55	6888.06	6591.65	6337.1	6189.76	6084.84	6107.94	6189.67	6230.8	6178.82	6037.22	5731.96];
recoveredt = [3.98	4.61	5.16	5.63	6.06	6.49	6.92	7.37	7.76	8.16	8.59	9	9.39	9.88	10.47	11.31	14.39	21.43	33.04	50.51	76.08	113.69	164.78	237.24	332.73	458.67	619.76	819.37	1059.57	1349.71	1681.96	2061.84	2490.22	2972.22	3512.35	4114.63	4773.33	5489.04	6258.08	7077.49	7939.88	8842.88	9780.9	10751.06	11753.24	12784.59	13838.35	14913.22	15997.27	17084.47	18175.98	19275.27	20384.65	21513.88	22669.49	23866.57	25114.02	26414.22	27763.18	29156.65	30585	32034.45	33489.59	34942.02	36382.49	37808.57	39227.31	40641.08	42055.12	43476.04	44900.51	46328.67	47754.73	49160.14	50535.08	51874	53168.45	54422.63	55639.31	56821.57	57981.1	59126.02	60259.59	61384.76	62499.63	63607.76	64718.98	65829.84	66936.37	68039.18	69138.02	70232.1	71308.96	72352.31	73360.92	74339.43	75290	76213.88	77109.47	77986.84	78851.04	79702.92	80535.27	81337.63	82107.73	82845	83542.08	84201.18	84821.33	85404.71	85956.94	86481.12	86982.04	87465.2	87929.55	88378.24	88808.61	89230.16	89643.39	90044.55	90433.47	90814.98	91188.94	91567.63	91939.06	92303.55	92665.98	93025.55	93381.82	93736.67	94083.43	94427.14	94765.78	95095.59	95419.27	95735.43	96042.14	96342.39	96639.31	96938.2	97243.12	97554.65	97876.29	98211.67	98560.59	98925.43	99306.14	99702.45	100113.22	100527.76	100955.86	101396.14	101842.35	102291.27	102740.35	103190.31	103656.9	104116.55	104568.27	105012.84	105447.92	105876.22	106296	106699.69	107096.18	107487.29	107874.96	108263.14	108649.27	109034.18	109416.78	109800.16	110182.94	110563.45	110941.02	111316.65	111689.71	112058.78	112425.37	112790.55	113155.67	113521.69	113889.18	114260.69	114630.49	115009.33	115401.71	115814.29	116250.29	116713.22	117203.47	117741.63	118305.67	118889.73	119484.27	120083.84	120686.08	121292.76	121896.14	122516.55	123159.92	123834.86	124546.88	125300.59	126096.71	126939.33	127817.16	128732.22	129685.98	130682.88	131727.31	132827.8	133987.27	135215.59	136514.71	137888.65	139342.88	140878.96	142493.84	144167.35	145908.08	147711.04	149570.78	151475.61	153413.08	155369.27	157369.39	159385.12	161415.39	163452.45	165491.86	167533.33	169583.45	171631.33	173688.67	175760.76	177855.06	179986.57	182159.92	184373.73	186610.22	188894.14	191219.92	193573.96	195953.35	198352.69	200771.96	203244.33	205731.49	208218.49	210746.06	213316.67	215940.41	218627.82	221387.45	224251.22	227277.45	230441.24	233739.55	237194.22	240817.31	244583.76	248480.12	252453.82	256491.14	260607.2	264780.8	268989.37	273235.92	277528.55	281897.57	286369.71	290918.1	295545.67	300262.33	305142.16	310181.47	315373.22	320716.57	326235.59	331946.65	337849.31	343791.9	349784.8	355814.67	361876.39	367960.73	374031.18	380087.94	386214.43	392418.67	398716.18	405103.71	411500	417865.61	424287.98	430717.92	437162.33	443599.06	450001.92	456438.84	462970.88	469363.9	475863.98	482352.08	488850.69	495388.31	502044.33	508852.53	516008.16	523182.76	530503.78	537963.16	545581.55	553296.43	561055.59	568817.1	576655.57	584516.49	592388.49	600203.39	607915.84	615530.41	622996.92	630337.59	637548.8	644583.78	651442.37	658136.37	664647.51	670990.18	677171.39	683167.59	688996.29	694669.96	700184.39	705531.14	710715.96	715799.12	720790.37	725710.96	730564.8	735345.57	740067.16	744720.06	749140.18	753385.41	757454.35	761365.35	765135.47	768773.94	772297.2	775851.78	779368.02	782846.31	786274.04	789654.94	792977.86	796241.18	799411.2	802519.96	805576.31	808585.98	811557.04	814507.51	817439.84	820362.92	823285.29	826204.43	829124.78	832050.12	834978.02	837919.55	840867.78	843820.06	846786.31	849770.63	852762.59	855762.69	858765.35	861776.22	864800.82	867831.61	870874.82	873947.02	877051.24	880191.27	883376.49	886613.67	889919.31	893298.9	896728.59	900219.53	903793	907416.45	911165.96	915051.37	919090.59	923350.08	927837.94	932544.22	937565.59	942775.59	948176.08	953753.35	959484.06	965380.41	971459.94	977694.53	984156.86	990850.9	997819.92	1005073.71	1012597.53	1020372.08	1028350.69	1036504.24	1044807.84	1053173.65	1061547.61	1069908.73	1078239.29	1086523.08	1094747.49	1102902.78	1111013.73	1119083.82	1127104.82	1135080.29	1143008.29	1150889.8	1158710.65	1166461.18	1174153.51	1181792.59	1189368.82	1196893.94	1204369.92	1211810.37	1219202.94	1226517.73	1233736.31	1240848.96	1247750.1	1254495.88	1261055.24	1267429.61	1273621.63	1279629.67	1285444.69	1291216.43	1296788.45	1302160.12	1307312.76	1312228.35	1316896.94	1321315.29	1325405.45	1329239.24	1332823.24	1336176.22	1339321.86	1342277.53	1345059.18	1347690.16	1350188.96	1352570.02	1354839.2	1357003.59	1359065.67	1361029	1362895.14	1364671.12	1366359.06	1367958.35	1369460.98	1370872.24	1372199.02	1373454.92	1374638.8	1375755.39	1376808.16	1377832.55	1378827.37	1379789.78	1380706.2	1381581.55	1382417.39	1383229.02	1383991.08	1384711.47	1385397.04	1386055.49	1386686.8	1387295.31	1387876.2	1388432.8	1388965.96	1389477.16	1389972.12	1390451.65	1390911.78	1391361.37	1391809.53	1392254.73	1392694.18	1393127.63	1393560.92	1394004.33	1394444.63	1394877.22	1395305.18	1395731.16	1396147.49	1396567.22	1396987.61	1397419.69	1397871.06	1398342.29	1398836.47	1399384.57	1399964.18	1400579.61	1401233.35	1401928.73	1402668.86	1403453.88	1404271.53	1405124.51	1406027.88	1406988.9	1408010.12	1409093.88	1410243.57	1411511.12	1412930	1414488.14	1416176.96	1418009.98	1419985.2	1422102.55	1424286.88	1426519.84	1428802.31	1431146.04	1433531.8	1435962.86	1438434.1	1440886.16	1443425.55	1446051.43	1448758.41	1451552.9	1454431.27	1457400.33	1460650.37	1463970.16	1467369.12	1470845.39	1474393.24	1478009.94	1481688.63	1485330.98	1489040.24	1492802.29	1496617.71	1500495.49	1504425.16	1508391.08	1512414.61	1516504.27	1520658.73	1524838.61	1529052.31	1533318.02	1537666.94	1542024.37	1546365.18	1550680.53	1555023.2	1559346.18	1563636	1567872.35	1571945.73	1576005.16	1580045.12	1584034	1587985.33	1591905.69	1595798.96	1599930.39	1604000.24	1608018.12	1611984.96	1615891.37	1619728.45	1623490.1	1626987.33	1630345.59	1633601.41	1636742.69	1639783.04	1642721.41	1645556.47	1648343.45	1651114.14	1653759.45	1656355.76	1658901.08	1661403.96	1663870.29	1666333.29	1668741.18	1671239.98	1673684.51	1676113.39	1678529.86	1681025.06	1683490.8	1686043.92	1688554.67	1691142.53	1693753.24	1696385.2	1698865.65	1701367.31	1703824.14	1706326.39	1708825.22	1711341.57	1713874.24	1716505.06	1719140.55	1721783.08	1724369.1	1726931.8	1729481.08	1732022.1	1734562.41	1737111.27	1739676.45	1742292.29	1744947.18	1747639.61	1750371.41	1753143.63	1755967.69	1758839.94	1761765.33	1764750.04	1767811.45	1770958.2	1774201.84	1777551.29	1781028.06	1784648.51	1788434.73	1792407.88	1796598.06	1801041.08	1805732.31	1810716.88	1816245.31	1822456.24	1829488.33	1837528.45	1846803.82	1857561.06	1870192.45	1884528.47	1900669.8	1918793.69	1938573.88	1960310.61	1984085.22	2009435.45	2036526.51	2065426.35	2096164.08	2129466.12	2164426.57	2200750.8	2238401.84	2277014.92	2316137.33	2354914.61	2392186.43	2427965.78	2461997.63	2494218.39	2524575.27	2553084.37	2580058.55	2605932.14	2630909.12	2655085.9	2678417.18	2700855.22	2722458.61	2743268.06	2763312.65	2782657.98	2801253.49	2819171.45	2836547.1	2853150.1	2868921.96	2883954.27	2898226.71	2911850.33	2924835.8	2937186.33	2949076.47	2960713.51	2971949.65	2982809.9	2993129.1	3002918.63	3012338.18	3022332.29	3032815.86	3043835.1	3055443.29	3067979.04	3081390.06	3095422.65	3108257.9	3119924.29	3130521.45	3139971.8	3148083.39	3154992.06	3160818.45	3166525.14	3172140.27	3177625.47	3183035.14	3188405.67	3193690.18	3198899.1	3203999.1	3208917.94	3213667.86	3218252.82	3222645.06	3226939.63	3231119.82	3235198.57	3239235.69	3243238.18	3247214.27	3251225.82	3255185.24	3259144.04	3263105.57	3267093.14	3271114.41	3275187.02	3279286.43	3283259.02	3287287.51	3291420.51	3295670.37	3300048.31	3304555.63	3309271.67	3314519.84	3319936.84	3325514.43	3331181.18	3336990.29	3342872.37	3348832.18	3354702.1	3360661.37	3366702.2	3372926.33	3379192.94	3385598.1	3392015.84	3397836.29	3403629.1	3409367.61	3414966.59	3420479.84	3425834.96	3431082.55	3437386.65	3443597.63	3449729.51	3455796.73	3461942.63	3468192.04	3474298.6	3480451.949	3486605.298	3492758.647	3498911.996	3505065.345];
hospitalt = [0	0	0	0	0	0	0.14	0.43	0.86	1.49	2.65	4.51	7.2	10.63	15.16	21	28.53	38.27	50.24	64.94	83.02	104.49	132.2	167.63	211.24	264.49	330.04	409.06	502.2	604.47	711.61	822.8	935.14	1042.76	1142.82	1233.9	1318.55	1400.63	1478.02	1552.73	1626.78	1700.92	1775.1	1845.94	1911.31	1973.9	2032.8	2090.71	2147.53	2204.14	2264.84	2329.84	2397.67	2467.88	2536.47	2603.61	2667.04	2725.67	2779	2827.84	2871.92	2911.92	2946.47	2977.47	3002.18	3023.22	3037.86	3047.29	3052.02	3052.45	3047.43	3039.69	3026.78	3011.73	2988.37	2957.88	2921.55	2880.41	2833.69	2780.65	2719.24	2660.16	2602	2544.47	2487.35	2431.69	2379.37	2332.45	2285.67	2239.37	2193.2	2146.76	2098.63	2048.18	1994.1	1936.43	1875.94	1814	1751.82	1689.65	1628.14	1567.08	1507.04	1447.69	1387.1	1325.9	1264.76	1203.2	1143.76	1086.88	1034.16	987.96	947.73	913.55	886.27	862.71	842.67	822.78	802.33	780.08	756.71	731.08	705.04	677.88	653.06	629.76	609.76	591.41	574.8	560.63	549.24	539.51	531.22	523.04	516.1	511.31	506.63	503	500.41	499.02	497.78	495.49	491.51	486.86	479.9	470.1	457.63	444.9	433	421.94	411.53	402.14	393.69	386.31	378.9	371.18	363.08	354.65	346.04	337.22	328.71	320.53	312.47	304.47	296.63	289.82	284.1	278.71	273.51	268.43	264.16	260.51	256.61	252.98	250.16	248.22	247.41	247.31	248.35	250.65	253.35	256.08	258.67	261.06	263.08	263.86	263.86	263.98	264.12	264.73	265.67	267.22	270.24	273.78	277.57	281.9	286.69	292.22	298.41	305.29	314.2	324.71	336.71	350.49	365.96	383.22	402.04	421.67	442.8	465.63	488.86	512.98	538.02	564.2	591.29	619.33	648.02	678.35	708.86	738.71	767.57	795.65	821.92	846.53	870.06	892.96	915.9	938.8	960.73	982.24	1002.57	1021.22	1038.96	1055.86	1071.12	1085.98	1100.35	1114.96	1126.63	1138.02	1148.59	1160.61	1174.18	1190	1208.14	1233.43	1259.96	1289.76	1321.53	1355.65	1391.71	1430.2	1470.59	1515.65	1563.37	1613.9	1666.35	1719.94	1773.31	1824.61	1873.57	1921.16	1966.37	2008.45	2049.31	2089.76	2131.16	2174.69	2220.12	2268.63	2322.16	2377.98	2436.73	2496.9	2558.8	2621	2683.96	2745.51	2807.37	2867.27	2925.31	2978.76	3029.88	3078.45	3125.94	3171.88	3216.69	3261.33	3306.9	3352.18	3394.63	3432.82	3467.39	3501.1	3528.14	3552.73	3575.69	3597.94	3628.57	3666.57	3709	3758.53	3813.22	3874.29	3946.04	4016.04	4083.53	4149.71	4224.53	4301.06	4375.63	4444.92	4509.08	4570.29	4627.98	4673.82	4711.27	4739.24	4754.43	4759.82	4752.49	4732.33	4701.16	4659.73	4609.33	4553.53	4492.35	4428.14	4361.86	4291.98	4218.61	4143.88	4066.47	3986.73	3906.39	3824.43	3741.18	3658.53	3575.33	3491.8	3411.65	3329.82	3245.96	3162.47	3078.9	2997.18	2918.67	2840.33	2768.41	2705	2647.86	2597.22	2550.82	2510	2473.41	2436.69	2400.82	2366.33	2332.51	2301.1	2269.35	2240.37	2215.98	2194.31	2175.02	2158.59	2143.65	2131.37	2120.1	2109.45	2099.43	2091.45	2083.37	2077.9	2074.61	2073.76	2075.02	2079.02	2084.35	2094.69	2106.78	2121.37	2138.35	2158.45	2180.14	2204.94	2229.14	2251.2	2274.27	2298.76	2324.12	2353.06	2375.14	2393.86	2415.82	2437.37	2463.22	2494.2	2528.35	2583.37	2657.84	2748.78	2854.61	2966.94	3084.43	3206.84	3327.82	3446.8	3561.43	3672.53	3781.22	3888.33	3991.78	4085.94	4166.98	4237.22	4295.41	4342.08	4373.88	4393.65	4403.65	4407.29	4399.22	4384.59	4363.82	4338.45	4308.39	4273.37	4233.59	4193.78	4148.92	4100.8	4052.82	4003.43	3955.14	3906.16	3856.78	3808.84	3760.8	3708.98	3653.94	3593.65	3530.98	3464.9	3391.61	3314.53	3237.12	3160.24	3083.9	3007.73	2930.27	2856.08	2779.67	2698.69	2613.16	2525.27	2437.59	2352.59	2269.24	2191.51	2118.61	2050.78	1987.31	1924.35	1861.65	1799.08	1736.27	1675.45	1616.57	1558.82	1503.9	1451.16	1400.76	1352.04	1304.88	1259.14	1216.35	1175.88	1138.73	1104.53	1073.67	1046.08	1019.8	994.06	968.82	942.88	917.39	892.45	866.71	843.76	822.08	801.63	783.14	765.41	747.76	731.02	713.65	696.69	680.37	664.33	649.02	634.24	620.41	606.98	593.94	580.73	567.92	555.63	544.43	533.55	523.31	513.88	505.73	498.41	491.35	485.67	481.8	479.94	480.35	482.22	486	492.63	500.16	509.04	519.02	529.57	541.24	553.71	567.39	583.59	601.51	621.61	643.84	668.76	696.65	727.84	761.2	797.33	835.65	877.02	918.37	960.02	1001.92	1045.12	1088.04	1130.98	1171.73	1214.78	1257.82	1300.04	1342.88	1388.33	1435.61	1486.98	1539.61	1597.55	1659.08	1719.9	1778.57	1835.57	1889.57	1941.94	1988.33	2031.27	2072.27	2112.27	2150.9	2189.24	2225.16	2259.53	2292.35	2322.98	2350.55	2374.37	2393.12	2408.63	2422.45	2432.33	2440.82	2448.65	2457.39	2467.37	2478.63	2490.22	2498.69	2504.35	2506.24	2503.78	2497.35	2487.04	2472.33	2461.02	2448.18	2434.45	2418.55	2400.69	2379.37	2355.37	2324.71	2292.31	2257.27	2222.14	2186.71	2152.55	2120.02	2090.53	2062.98	2038.76	2016.24	1995.29	1975.49	1956.14	1937.43	1917.84	1897.57	1875.92	1854.59	1832.84	1812.16	1791.96	1773.82	1756.45	1742.51	1729.61	1718.18	1706.84	1695.67	1684.27	1672.37	1658.78	1644.02	1629.12	1615.43	1601.49	1588.49	1577.94	1568.82	1561.53	1557.82	1555.06	1553.35	1550.14	1544.92	1538.96	1532.33	1521.06	1507.73	1495.29	1485.27	1477.31	1472.04	1470.37	1474.1	1482.1	1492.04	1504.61	1522.27	1544.29	1568.06	1593.98	1626.71	1665.47	1717.02	1785.84	1876.76	1993.98	2138.86	2306.82	2508.57	2749.08	3023.08	3327.78	3664.73	4029.88	4428.82	4863.12	5309.16	5765.02	6228	6693.41	7158.94	7626.41	8072.27	8498.69	8897.61	9262.04	9584.55	9869.67	10099.59	10280.82	10422.49	10525.1	10591.29	10627.37	10627.9	10597.94	10542.55	10453.82	10343.02	10210.18	10055.43	9887.51	9708.9	9520.08	9328.61	9130.88	8933.88	8740.12	8547.82	8355.88	8164.1	7972.8	7784.31	7597.37	7412.43	7229.12	7057.63	6893.61	6738.41	6589.8	6445.37	6305.57	6168.2	6023.78	5880.49	5737.86	5598.69	5465.29	5334.8	5209.69	5095.24	4988.61	4890	4796	4706.78	4624.51	4549.71	4477.53	4408.45	4338.98	4271.57	4205.67	4139.88	4071.1	4006.22	3945.39	3893.96	3852.2	3820.55	3800.94	3793	3795.96	3809.55	3832.43	3863.31	3901.78	3946.69	4000.92	4061.14	4123.1	4192.04	4268.69	4352.96	4444.47	4538.84	4637.02	4751.14	4868.71	4989.63	5112.02	5227.49	5343.59	5460.22	5565.18	5667.86	5765.41	5858.39	5961.76	6063.12	6158.94	6254.61	6340.22	6414.45	6477.29	6519.92	6550.37	6569.73	6575.33	6572.29	6563.37	6549.02	6520.06	6489.76	6456.98	6415.45	6364.14	6303.04	6232.55	6166.8];
icut = [0	0	0	0	0	0	0.04	0.12	0.24	0.41	0.71	1.31	2.33	3.78	5.8	8.47	11.96	16.49	21.92	28.12	35.43	43.98	54.9	68.57	84.65	103.53	126.94	155.08	187.55	222.45	259.1	297.31	336.76	374.51	408.71	439.49	467.12	491.24	511.84	527.92	539.59	548.27	554.86	558.06	558.41	556.35	552.73	548.9	545.49	540.12	536.16	532.98	530.41	528.76	527.57	525.24	523.37	520.41	517.18	513.45	508.76	503.86	499.27	494.76	489.65	483.71	476.94	469.78	461.2	452	442.2	432.61	423.45	415.02	406.88	399.41	392.12	385.14	378.35	371.73	365.22	359.35	354.1	349.37	344.98	340.82	336.49	332.1	327.06	321.47	315.37	309.1	302.59	295.9	288.78	281.55	274.55	268.02	261.61	254.96	248.31	241.69	234.78	226.9	218.14	208.82	199.94	191.02	182.33	174.27	167.39	161.31	155.59	149.45	143.59	137.61	131.41	124.71	117.96	111.45	105.51	99.69	94.41	89.71	85.69	82.18	79.1	76.37	74.2	72.57	71.2	69.98	68.8	67.9	67.35	67.18	67.06	67.35	68.2	69.45	70.65	71.59	71.94	72.04	71.61	70.73	69.78	68.98	68.57	68.71	69.49	71	72.78	74.51	76.22	77.8	79.12	79.61	79.22	78.31	77.2	75.71	73.9	71.86	70.08	68.61	67.41	66.06	64.59	62.9	61.08	59	56.63	54.1	51.8	49.92	48.69	48.12	48.29	49.12	50.29	51.55	52.88	54.1	55.12	55.76	56.04	56.16	56.16	55.92	55.49	55	54.84	55.2	56.31	58.1	60.73	64.14	67.98	71.84	75.51	78.88	82.08	85.31	88.43	91.65	95.1	98.86	102.71	106.61	110.14	113.76	117.47	121.33	125	128.9	132.86	136.98	140.78	144.33	148.12	152.47	156.96	161.84	167.08	172.9	179.2	185.08	190.47	195.76	200.69	205.29	209.55	213.45	217.16	220.78	223.49	225.67	226.98	227.69	227.73	227.57	227.18	227.45	228	229.86	232.22	235.8	240.47	246.45	253.67	262.53	272.18	283.73	296.24	309.78	323.73	338.1	351.92	365.61	378.24	390.24	400.96	410.9	419.16	426.86	433.8	440.24	446.41	453.24	460.65	469.53	479.63	490.59	502.2	514.16	525.71	537.06	547.92	558.31	568.92	580.39	592.18	604.59	617.27	630.08	642.49	654.12	664.31	673.69	681.84	688.45	693.82	698.31	701.88	704.73	707.04	709.82	713.84	719.33	726.16	734.1	743.82	754.82	766.41	778.1	788.92	799.12	809.51	818.84	827.63	835.59	843.02	850.65	857.92	864.1	869.65	873.94	877.33	879.08	878.9	877.39	875.16	872.53	869.9	866.92	864.29	861.96	859.8	856.41	851.71	845.65	838.41	829.29	818.69	806.47	793.82	780.94	767.84	754.41	741.45	728.31	715.02	701.31	686.82	671.73	657.27	643.16	630.06	618.1	607.45	598.49	591.16	584.55	578.84	574.2	570.82	568.53	567.14	566.39	566.22	565.84	565.24	564.12	562.82	560.8	558.24	555.39	553.02	550.76	548.76	546.69	545.29	544.96	545.2	546.39	548.51	551.71	556.02	561.29	566.55	572.78	579.27	586.06	593.53	601.94	611.12	621.92	633.16	644.86	657.98	671.45	685.43	700.51	716.63	734.9	755.43	776.96	800.51	825.96	852.65	880.29	907.78	935.57	963.73	992.31	1020.88	1049.57	1078.24	1107.94	1138.18	1169.22	1199.71	1229.61	1258.67	1287.14	1313.84	1338.22	1360.37	1380.47	1398.47	1414.31	1427.18	1437.71	1445.92	1450.94	1453.18	1452.24	1448.35	1441.96	1432.65	1421.12	1408.43	1395.35	1382.94	1371.47	1361.18	1352.8	1345.69	1338.76	1330.92	1321.1	1308.35	1293.39	1275.92	1256.65	1236.41	1215.24	1193.84	1173.35	1152.61	1131.08	1108.29	1083.96	1058.18	1031.14	1002.37	972.16	941.47	910.67	880.84	852.73	825.92	801.04	777.88	755.86	735.02	714.33	693.67	673.37	652.69	632.33	612.98	594.61	577.63	561.57	546.9	533.76	521.59	509.88	498.47	487.71	477.37	466.63	455.35	443.84	432.27	420.39	407.61	394.67	382.02	369.98	358.69	348.14	338.47	329.53	320.92	312.41	303.8	294.92	285.92	277.18	269.18	262.08	256	250.88	246.61	243.04	239.65	236.35	232.94	229.29	225.53	221.73	217.71	213.98	210.35	207.16	204.63	202.84	201.63	201.31	201.65	203.06	205.24	208.1	211.53	216.1	221.73	228.51	235.73	243.67	252.12	261.14	270.67	280.59	290.55	301.43	312.8	325.1	337.98	350.92	364.22	378	391.47	404.98	418.16	431.71	445.24	459.08	473.51	488.61	504.27	520.65	537.2	555	572.9	590.2	607.39	624.2	640.06	654.98	668.12	679.59	690.27	699.45	707.65	715.33	722.65	729.96	737.59	744.69	751.82	757.53	762.18	765.94	768.08	768.71	768.06	765.86	763.78	761.47	758.43	755.2	752.02	749.14	746.69	744.2	741.82	739.96	738.86	737.63	735.86	733.49	729.96	724.76	717.57	708.08	697.31	686.18	674.96	664.31	654.92	647.06	640.73	635.71	631.24	626.08	619.86	612.29	603.18	592.86	581.27	568.47	556.31	545.06	534.94	526.14	518.73	512.33	507.18	502.39	497.94	493.53	489.14	484.73	480.78	477.18	474.49	472.63	471.55	471.16	471.18	471.45	471.8	471.63	470.78	469.86	468.88	468.02	467.12	465.96	464.76	463.69	461.9	459.78	457.29	455	453.37	452.31	451.63	451.98	452.73	454.04	455.29	456.45	457.88	459.65	461.33	462.86	464.35	465.76	467.67	470.08	473.88	479.41	487.12	496.69	510.12	527	547.61	571.31	599.24	631.82	669.2	709.24	751.71	795.08	838.84	881.08	921.08	958.86	994.24	1026.53	1056.73	1084.51	1110.18	1133.27	1153.18	1170.45	1184.65	1195.16	1202.94	1207.69	1209.94	1209.73	1206.14	1200.41	1193.16	1183.31	1171.08	1156.37	1139.69	1122.35	1104.18	1085.04	1065.88	1046.86	1028.1	1008.9	988.63	967.24	945.08	922	898.35	874.51	851.86	830.53	810.35	790.78	772	753.92	736.39	718.06	699.43	681.31	664.2	647.8	632.14	617.06	603.65	591.57	580.1	569.18	558.9	549.18	540.16	531.16	522.16	512.98	503.31	493.2	482.51	471.27	459.78	448.29	437.57	427.96	419.82	413.29	408.29	404.41	401.59	399.37	397.67	395.92	394.27	392.8	391.73	390.8	389.94	388.82	387.86	386.98	386.08	385.45	385.31	386.04	388.16	391.43	395.84	401.18	407.18	413.88	420.53	426.59	432.22	436.92	440.98	444.2	446.35	447.88	449.06	449.65	449.47	448.39	447.12	445.49	443.43	440.76	437.55	434.86	432.43	428.65	424.31	419.18	413.67	407.82	400.78];
deatht = [0	0	0.02	0.06	0.14	0.27	0.43	0.63	0.88	1.18	1.61	2.12	2.8	3.65	4.8	6.27	8.04	10.06	12.51	15.31	18.69	22.59	26.96	32.27	38.59	45.88	54.63	65.31	78.65	95.63	116.06	140.88	170.84	206.35	246.92	292.59	342.71	397.39	456.94	521.57	592.16	670.06	755.96	850.55	954.39	1066.55	1186.65	1313.1	1444.71	1580.08	1717.84	1857.78	1999.63	2142.67	2287.02	2433.33	2581.73	2733.04	2887	3044.2	3205.78	3371.14	3538.33	3706.04	3875.12	4044.04	4211.78	4376.16	4537.29	4694.63	4849.1	4997.9	5140.78	5275.84	5403.84	5524	5637.94	5745.55	5847.67	5946.82	6045.63	6144.63	6244.55	6345.31	6446.92	6553.2	6661.08	6769.55	6877.98	6987.12	7096.16	7204.84	7306.04	7401.69	7492.16	7577.1	7653.82	7722.82	7784.35	7842.63	7897.47	7948.51	7996.12	8042.69	8088.27	8133.2	8176.88	8218.94	8259.47	8298.69	8335.84	8370.37	8401.37	8429.06	8454.08	8476.98	8497.86	8517.39	8536.49	8555.67	8575.06	8594.39	8613.37	8632.16	8650.33	8667.43	8683.82	8699.53	8714.63	8729.06	8742.49	8755.33	8767.84	8779.86	8791.27	8802.08	8812.43	8822.51	8831.96	8840.63	8848.53	8855.8	8862.55	8869.02	8875.27	8881.67	8888.33	8895.37	8902.76	8910.2	8917.57	8924.82	8931.69	8938.18	8944.24	8949.92	8955.47	8960.76	8966.06	8971.61	8977.47	8983.59	8989.9	8996.31	9003.12	9009.92	9016.51	9022.98	9029.43	9035.92	9042.53	9049	9055.51	9062.2	9068.9	9075.49	9082.02	9088.39	9094.67	9100.88	9106.9	9112.69	9118.24	9123.47	9128.22	9132.55	9136.45	9140	9143.33	9146.59	9149.82	9153.31	9157.08	9161.22	9165.67	9170.53	9175.67	9181.22	9187.1	9193.2	9199.55	9206.14	9212.9	9219.86	9226.92	9234	9241.31	9248.69	9256.51	9266.45	9279.43	9295.71	9315.59	9339.18	9366.65	9397.55	9428.9	9459.14	9487.73	9514.29	9538.49	9560.2	9579.96	9598.92	9617.71	9636.82	9656.37	9676.24	9697.02	9718.22	9740.02	9762.59	9785.96	9810.29	9835.98	9862.43	9889.88	9918.47	9947.84	9978.16	10009.31	10041.9	10076.55	10113.14	10151.86	10193.31	10236.76	10282.67	10330.12	10378.49	10428.49	10479.84	10532.33	10587.1	10644.06	10703.08	10765.2	10829.57	10896.27	10965.29	11035.51	11106.37	11178.82	11251.73	11325.41	11400.18	11476.02	11553.39	11633.1	11714.06	11796.88	11881.2	11966.39	12052.45	12139.65	12227.63	12316.9	12407.04	12499.1	12594.29	12692.49	12793.41	12896.96	13003.29	13112.84	13224.53	13336.92	13450.18	13564.08	13678.04	13792.43	13907.45	14023.73	14141.27	14259.49	14378.65	14500.8	14626.39	14754.1	14883.2	15013.73	15145.84	15278.82	15409.59	15536.22	15659.2	15780.55	15901.43	16022.53	16145.82	16273.08	16404.86	16541.57	16680.37	16821.71	16965.22	17110.18	17255.59	17401.67	17549.08	17699.04	17850.57	18003.67	18157.1	18312.24	18469.51	18626.61	18782.86	18936.53	19087.18	19234.63	19377.59	19513.88	19645.08	19772.35	19896.24	20016.18	20132.59	20244.94	20354.96	20461.45	20562.35	20658.04	20748.82	20835.02	20916.94	20994.61	21067.84	21137.69	21204.71	21269.2	21330.73	21390.43	21447.61	21503.59	21558.69	21612.27	21664.37	21715.22	21763.94	21810.98	21856.51	21900.39	21943	21984.04	22023.55	22062.35	22100.65	22137.57	22173.14	22207.39	22240.98	22274.14	22306.49	22337.94	22369.16	22400.37	22431.59	22462.57	22493.33	22524.12	22554.94	22585.47	22615.61	22645.67	22675.73	22705.61	22734.73	22763.35	22791.86	22820.61	22849.29	22877.73	22905.98	22934.45	22963.41	22992.65	23021.84	23051.33	23081.61	23112.86	23145.45	23178.78	23213.29	23249.43	23287	23325.9	23366.16	23407.45	23450.16	23493.82	23538.14	23583.53	23629.65	23676.47	23724.22	23772.61	23821.67	23871.24	23920.69	23970.06	24019.29	24067.71	24115.71	24163.41	24210.55	24257.16	24303.22	24349.1	24395.43	24441.49	24487.18	24533.2	24579.84	24627.14	24674.37	24720.78	24766.9	24812.61	24857.31	24901.04	24943.86	24985.88	25027.31	25068.78	25110.18	25151.88	25193.27	25234.24	25275.18	25316.59	25356.69	25395.9	25433.73	25470.78	25506.98	25541.78	25574.94	25607.76	25640.16	25672.49	25704.16	25735.18	25766.1	25796.41	25825.82	25853.73	25879.82	25904.47	25927.86	25949.98	25971.24	25992.55	26014.18	26036.65	26059.88	26083.51	26107.29	26131.24	26153.9	26175.45	26195.9	26215.67	26234.92	26253.76	26272.16	26290.33	26307.92	26324.71	26340.29	26354.76	26368.1	26380.24	26391.61	26402.55	26413.08	26423.39	26433.39	26443.1	26452.69	26462.06	26471.08	26479.84	26488.18	26496.24	26504	26511.43	26518.73	26526.12	26533.43	26540.78	26548.16	26555.61	26563.02	26570.31	26577.39	26584.69	26592.22	26600.02	26608.2	26617.02	26626.47	26636.37	26646.14	26655.53	26664.35	26672.37	26679.33	26685.37	26691.47	26698.31	26706.1	26714.94	26725.02	26736.82	26750.69	26765	26779.1	26793.41	26808.1	26823.14	26838.06	26851.94	26866.08	26881.16	26896.55	26912.14	26927.96	26943.78	26960.65	26978.31	26996.29	27015.24	27035.33	27056.57	27080.1	27104.88	27130.73	27157.57	27185.14	27213.16	27241.59	27269.61	27298.22	27327.53	27358.16	27389.82	27422.61	27456.63	27492.06	27528.33	27565.61	27603.22	27641.88	27681.73	27722.49	27764.02	27806.16	27848.53	27891.22	27933.18	27973.92	28013.61	28051.43	28088.1	28124.04	28159.82	28195.94	28232.82	28270.51	28311.06	28353.1	28395.51	28437.22	28478.51	28519.31	28559.41	28596.86	28632.33	28667.02	28702.02	28736.24	28769.57	28802.16	28834.59	28866.84	28897.88	28927.41	28956.06	28983.82	29010.78	29037.37	29063.63	29090.16	29115.96	29141.71	29167.67	29194.67	29221.55	29248.33	29274.9	29302.39	29329.71	29356.65	29381.2	29404.84	29427.78	29450.06	29471.16	29491.61	29511.49	29531.8	29552.08	29571.96	29591.53	29611.08	29630.65	29650.22	29669.78	29689.08	29708.55	29728.1	29747.69	29767.37	29787.16	29807.29	29827.61	29847.98	29868.43	29888.82	29908.98	29928.86	29948.22	29967.2	29985.65	30003.61	30021.22	30038.45	30055.31	30071.98	30088.73	30105.84	30123.41	30141.59	30161.02	30181.98	30204.78	30229.29	30255.94	30285.24	30317.71	30353.76	30394.22	30439.02	30488.98	30544.31	30605.49	30672.84	30746.39	30826.35	30912.82	31006.51	31107.71	31216.41	31333.76	31459.37	31591.59	31730.55	31875.37	32025.69	32181.33	32339.47	32499.35	32661.29	32824.43	32987.29	33148.67	33306.69	33461.76	33614.18	33763.47	33910.12	34054.41	34196.02	34335.31	34471.37	34603.78	34732.39	34855.94	34974.57	35088.61	35197.88	35303.06	35403.96	35500.18	35592.78	35679.92	35762.39	35840.61	35914.92	35986.22	36055.94	36124.1	36193.94	36263.67	36333.61	36403.59	36472.76	36540.94	36608.16	36673.24	36737.9	36801.63	36864.35	36916.78	36958.51	36989.2	36989.2	36989.2	36989.2	36998.18	36999.29	36999.45	36999.94	37009.53	37030.24	37059.08	37096.24	37132.61	37168.51	37203.96	37239.2	37274.8	37310.65	37345.67	37380.82	37415.9	37451.12	37486.33	37520.24	37554.16	37589.22	37625.06	37661.9	37699.65	37738.71	37780.88	37823.39	37867.08	37911.1	37955.53	38000.29	38045.33	38089.63	38135.31	38181.12	38228.96	38278.92	38331.1	38385.47	38442.35	38501.12	38562.08	38623.67	38685.12	38746.27	38806.88	38866.92	38926.49	38985.63	39044.61	39104.59	39166.41	39232.65	39304.92	39381.57	39440.99467	39508.19552	39575.39638];

% r =  1	: End_test		;
% 
%        daily = dailyt(r);
%       recovered = recoveredt(r);
%        death = deatht(r);
%       hospital = hospitalt(r);
%        icu = icut(r);
% isshow = 1;
% 
  
start_test = 1; %for the figures
End_test = params(2);   %for the figures
ti = 1; %Can be used to change the scale of the period; we did not used it.
Tu=params(1);   %stabilize DDE
%Tmax = 14;
Tmax = params(2)/ti; %Number of training data
tau = params(3)/Tu; %Incubation period

%mild

taumir = params(4)/Tu;  %The expected time for mild infected people to recover from the infection
taumih = params(5)/Tu;  %The expected time for mild infected people to develop symptoms requiring hospitalization 
taumid = params(6)/Tu;  %The expected time for mild infected people to die from the infection

%moderate
taumor = params(7)/Tu;  %The expected time for moderate infected people to recover from the infection
taumoh = params(8)/Tu;  %The expected time for moderate infected people to develop symptoms requiring hospitalization
taumod = params(9)/Tu;  %The expected time for moderate infected people to die from the infection
taumoi = params(10)/Tu; %The expected time for moderate infected people to develop symptoms requiring ICU

%severe
taush = params(11)/Tu;  %The expected time for severe infected people to develop symptoms requiring hospitalization
tausi = params(12)/Tu;  %The expected time for severe infected people to develop symptoms requiring ICU hospitalization
tausd = params(13)/Tu;  %The expected time for severe infected people to die from the infection

%hosp
tauhr = params(14)/Tu;  %The expected time for hospitalized people to recover from the infection
tauhi = params(15)/Tu;  %The expected time for hospitalized people to develop symptoms requiring transfer to ICU hospitalization
tauhd = params(16)/Tu;  %The expected time for hospitalized people to die from the infection

%ICU
tauir = params(17)/Tu;  %The expected time for ICU hospitalized people to recover from the infection
tauid = params(18)/Tu;  %The expected time for ICU hospitalized people to die from the infection


%% Rates Parameters
%rho
rhomi = params(19); %The expected proportion of infected people to develop mild symptoms after the incubation period
rhomo = params(20); %The expected proportion of infected people to develop moderate symptoms after the incubation period
rhos  = params(21); %The expected proportion of infected people to develop severe symptoms after the incubation period

%eta
etamir=params(22);  %The expected proportion of mildly infected people to recover from symptoms after the delay period
etamih=params(23);  %The expected proportion of mildly infected people to hospitalization from symptoms after the delay period
etamid=params(24);  %The expected proportion of mildly infected people to die from symptoms after the delay period 

etamor=params(25);  %The expected proportion of moderate infected people to recover from symptoms after the delay period
etamoi=params(26);  %The expected proportion of moderate infected people to ICU from symptoms after the delay period 
etamoh = params(27);%The expected proportion of moderate infected people to hospitalization from symptoms after the delay period
etamod = params(28);%The expected proportion of moderate infected people to die from symptoms after the delay period

etash = params(29);%The expected proportion of severe infected people to hospitalization from symptoms after the delay period
etasi = params(30);%The expected proportion of severe infected people to ICU from symptoms after the delay period
etasd = params(31);%The expected proportion of severe infected people to die from symptoms after the delay period

%lambda
lambdahr = params(32);%The expected proportion of hospitalized infected people to recover from symptoms after the delay period
lambdahi = params(33);%The expected proportion of hospitalized infected people to ICU from symptoms after the delay period
lambdahd = params(34);%The expected proportion of hospitalized infected people to die from symptoms after the delay period

%delta
deltaid = params(35);%The expected proportion of ICU hospitalized infected people to die from symptoms after the delay period
deltair = params(36);%The expected proportion of ICU hospitalized infected people to recover from symptoms after the delay period

%shift,scale
    
scale_r = params(37);%Recovered
scale_d = params(38);%death
scale_h = params(39);%hospitalized
scale_i = params(40);%ICU
Shift = 1;


%% Input Function & time
 daily_smooth = @(t) input(t,daily,ti);
%% = daily_smooth;


t = 1/ti:1/ti:Tmax;
n_obs = size(t,2);

%% Creating Vectors of parameters (Sets of parameters)
%This is for delay deferential equations
eta =[etamir etamih etamid etamor etamoh etamoi etamod etash etasi etasd]; 
lambda= [lambdahr lambdahi lambdahd];
delta= [deltair deltaid];
rho = [rhomi rhomo rhos];


lags = [taumir,taumih,taumid,taumor,taumoh,taumoi,taumod,taush,tausi,tausd,tauhr,tauhi,tauhd,tauir,tauid]; % define the delay
history = zeros(1,7); % I(t<tau)
tspan = 1/ti:1/ti:Tmax;
sol = dde23(@(t,y,Z)  ddefun(t,y,Z,eta,rho,lambda,delta,daily_smooth,tau),lags,history,tspan);

%% Check with Actual Data
rmse=[0 0 0 0]; % an array to contain the 4 rmse
mae=[0 0 0 0];
wape=[0 0 0 0];
mape=[0 0 0 0];

%Recovered
recovered_smooth = @(t) Data(t,recovered,ti);
pred_recovered = interp1q(sol.x',sol.y(6,:)',t');
pred_recovered = reshape(pred_recovered,[1,n_obs])*scale_r;
[rmse(1),wape(1),mae(1),mape(1)] = compute_error(recovered_smooth(start_test:End_test) , pred_recovered(start_test:End_test) , ti, Shift);


%death
death_smooth = @(t) Data(t,death,ti);
pred_death = interp1q(sol.x',sol.y(7,:)',t');
pred_death = reshape(pred_death,[1,n_obs])*scale_d;
[rmse(2),wape(2),mae(2),mape(2)] = compute_error(death_smooth (start_test:End_test), pred_death(start_test:End_test) , ti, Shift);


%Hospital
hospital_smooth = @(t) Data(t,hospital,ti);
pred_hospital = interp1q(sol.x',sol.y(4,:)',t');
pred_hospital = reshape(pred_hospital,[1,n_obs])*scale_h;
[rmse(3),wape(3),mae(3),mape(3)] = compute_error(hospital_smooth(start_test:End_test) , pred_hospital(start_test:End_test), ti,Shift);


%ICU
icu_smooth = @(t) Data(t,icu,ti);
pred_icu = interp1q(sol.x',sol.y(5,:)',t');
pred_icu = reshape(pred_icu,[1,n_obs])*scale_i;
[rmse(4),wape(4),mae(4),mape(4)] = compute_error(icu_smooth(start_test:End_test) , pred_icu(start_test:End_test)  , ti,Shift);


%Location of each error in the final result:
rmse_mae_wape_mape=[0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0];
for i=1:4
    rmse_mae_wape_mape(i)= rmse(i);
    rmse_mae_wape_mape(i+4)= mae(i);
    rmse_mae_wape_mape(i+8)= wape(i);
    rmse_mae_wape_mape(i+12)= mape(i);
end

%% Figures:
if (isshow == 1)    
    
    plot(1/ti:1/ti:Tmax,daily , '-o', 1/ti:1/ti:Tmax, daily_smooth(1/ti:1/ti:Tmax), '-x');
    saveas(gcf,'reports/daily.png')
    
    %Recovered

    figure()
    plot(t(1:end-Shift),recovered(1:end-Shift),'^-',t(1:end-Shift),pred_recovered(Shift+1:end) , '-o', t(1:end-Shift), recovered_smooth(t(1:end-Shift)), '-x');
    grid on;
    hold off
    xlabel('Time t');
    ylabel('recovered ');
    legend('Original','Prediction','Smooth');
    saveas(gcf,'reports/recovered.png')
    
    %death
    figure();
    plot(t(1:end-Shift),death(1:end-Shift),'^-' ,t(1:end-Shift),pred_death(Shift+1:end) , '-o',t(1:end-Shift), death_smooth(t(1:end-Shift)), '-x');
    grid on;
    title('Death')
    xlabel('Time t');
    ylabel('Death ');
    legend('Original','Prediction','Smooth');
    saveas(gcf,'reports/death.png')


    %hospital
    figure;
    plot(t(1:end-Shift),hospital(1:end-Shift),'^-' , t(1:end-Shift),pred_hospital(Shift+1:end) , '-o',t(1:end-Shift), hospital_smooth(t(1:end-Shift)), '-x');
    grid on;
    title('Hospital')
    xlabel('Time t');
    ylabel('Hospital ');
    legend('Original','Prediction-smooth','Smooth');
    saveas(gcf,'reports/Hospital.png')
    
    %icu
    figure;
    plot(t(1:end-Shift),icu(1:end-Shift),'^-' ,t(1:end-Shift),pred_icu(Shift+1:end)  , '-o',t(1:end-Shift), icu_smooth(t(1:end-Shift)), '-x');
    grid on;
    title('ICU')
    xlabel('Time t');
    ylabel('ICU ');
    legend('Original','Prediction-smooth','Smooth');
    saveas(gcf,'reports/icu.png')

    
end


end

%% Delay System
    % Z is the matrix: 
    %               The columns are the solutions to the system of DDE 
    %               The rows are the time-delayed solution
    %As an example:  Z(2,1) means: The first solution delayed with the
    %second lag
    %As an example: Imih(1) means that Z(1,2)
function dydt = ddefun(t,~,Z,eta,rho,lambda, delta,I,tau)
%delayed functions
Imir = Z(:,1); 
Imih = Z(:,2);
Imid = Z(:,3);
Imor = Z(:,4);
Imoh = Z(:,5);
Imoi = Z(:,6);
Imod = Z(:,7);
Ish  = Z(:,8);
Isi  = Z(:,9);
Isd  = Z(:,10);
Hr   = Z(:,11);
Hi   = Z(:,12);
Hd   = Z(:,13);
Ur   = Z(:,14);
Ud   = Z(:,15);
%Parameters

%rho
rhomi=rho(1,1);
rhomo=rho(1,2);
rhos=rho(1,3);
%eta
etamir=eta(1,1);
etamih=eta(1,2);
etamid=eta(1,3);
etamor=eta(1,4);
etamoh=eta(1,5);
etamoi=eta(1,6);
etamod=eta(1,7);
etash=eta(1,8);
etasi=eta(1,9);
etasd=eta(1,10);
%lambda
lambdahr=lambda(1,1);
lambdahi=lambda(1,2);
lambdahd=lambda(1,3);
%delta
deltair=delta(1,1);
deltaid=delta(1,2);

dydt = [rhomi*I(t-tau)-etamir*Imir(1)-etamih*Imih(1)-etamid*Imid(1);    
    rhomo*I(t-tau)-etamor*Imor(2)-etamoh*Imoh(2)-etamoi*Imoi(2)-etamod*Imod(2);
    rhos*I(t-tau)-etash*Ish(3)-etasi*Isi(3)-etasd*Isd(3);
    %Hospitalize
    etamih*Imih(1)+etamoh*Imoh(2)+etash*Ish(3)-lambdahr*Hr(4)-lambdahi*Hi(4)-lambdahd*Hd(4);
    %ICU
    lambdahi*Hi(4)+etasi*Isi(3)+etamoi*Imoi(2)-deltair*Ur(5)-deltaid*Ud(5);
    % Recovery
    etamir*Imir(1)+etamor*Imor(2)+lambdahr*Hr(4)+deltair*Ur(5);
    % death
    etamid*Imid(1)+etamod*Imod(2)+etasd*Isd(3)+lambdahd*Hd(4)+deltaid*Ud(5)];

end


%% Input function
function y = input(t,z,ti)
    if t <= 0
        y=0;
    else
        s=ceil(t)*ti;
        %disp(s);
        y=smoothdata(z(s),'movmedian',2);
    end
end
%% Actual Data

function R = Data(t,z,ti)
    if round(t) == 0
        R=0;
    else
        s=ceil(t*ti);
        R=smoothdata(z(s),'movmean',2);
    end
end

%% Calculate Error
function [rmse,wape,mae,mape] = compute_error(original , prediction , ti, Shift)  
    
    n_obs = size(prediction,2)-Shift;
    mean=0;
    mae = 0;
    rmse = 0;
    mape = 0;
    for i=1:n_obs
        mae=mae+( abs(original(i/ti)-prediction(i+Shift)) );
        rmse= rmse+(original(i/ti)-prediction(i+Shift))^2;
        mean= mean +original(i/ti);
        mape = mape + ( abs( (original(i/ti)-prediction(i+Shift))/(original(i/ti)+1) ) );
    end
    rmse=sqrt(rmse/n_obs);  %rmse: Root-mean-square error
    wape=mae/mean;          %wape: Weighted absolute percentage error
    mae=mae/n_obs;          %mae: Mean absolute error
    mape =mape/n_obs;       %mape: Mean absolute percentage error
    
end